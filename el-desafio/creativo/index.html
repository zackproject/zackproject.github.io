<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crear preguntas para El Desafio</title>
    <link rel="canonical" href="https://www.zksama.com/el-desafio">
    <link rel="icon" href="../../icopz.ico">
</head>

<body>
    <h1>Modo Creativo</h1>
    <form onsubmit="return createQuiz(event)" id="form-quiz">
        <fieldset>
            <legend>Crear Desafio</legend>
            <label for="question">Pregunta <span id="numQuiz">1</span>/10</label>
            <input id="question" name="question" type="text" placeholder="Pregunta" maxlength="60" required>
            <label for="answers">Opciones</label>
            <input name="answers" type="text" placeholder="Respuesta 1" maxlength="40" required>
            <input name="answers" type="text" placeholder="Respuesta 2" maxlength="40" required>
            <input name="answers" type="text" placeholder="Respuesta 3" maxlength="40" required>
            <input name="answers" type="text" placeholder="Respuesta 4" maxlength="40" required>
            <input type="submit">
        </fieldset>
    </form>

    <form onsubmit="return saveQuiz(event)">
        <fieldset>
            <legend>Marca las opciones correctas</legend>
            <div id="quizs-radio">
                <!-- autogenerated -->
            </div>
            <label for="title">Titulo del Desafio</label>
            <input id="title" name="title" type="text" required>
            <input type="submit">
        </fieldset>
    </form>
</body>
<style>
    fieldset {
        max-width: 400px;
        display: flex;
        flex-direction: column;
        gap: 10px;
    }
</style>
<script>
    const ELDESAFIOLIST = "challengequizlist";
    let questionList = [];
    let idQuiz = 0;

    const quizRadioHTML = (props) => {
        return `<fieldset>
                <legend>${props.id + 1}.${props.question}</legend>
                <div>
                    <input type="radio" id="radio-${props.id}" name="challenge-${props.id}" value="0" required />
                    <label for="radio-${props.id}">${props.options[0]}</label>
                </div>
                <div>
                    <input type="radio" id="radio-${props.id}" name="challenge-${props.id}" value="1" />
                    <label for="radio-${props.id}">${props.options[1]}</label>
                </div>
                <div>
                    <input type="radio" id="radio-${props.id}" name="challenge-${props.id}" value="2" />
                    <label for="radio-${props.id}">${props.options[2]}</label>
                </div>
                <div>
                    <input type="radio" id="radio-${props.id}" name="challenge-${props.id}" value="3" />
                    <label for="radio-${props.id}">${props.options[3]}</label>
                </div>
            </fieldset>`
    }

    let numberQuestion = document.getElementById("numQuiz");
    numberQuestion.innerText = idQuiz + 1;

    class QuizCreator {
        constructor(id, question, options) {
            this.id = id;
            this.question = question;
            this.options = options;
        }
    }

    class MyQuiz {
        constructor(id, name, quizCreator, answerList) {
            this.id = id;
            this.name = name;
            this.quizCreator = quizCreator;
            this.answerList = answerList;
        }
    }


    function saveQuiz() {
        let answerList = [];
        event.preventDefault();

        let a = document.querySelectorAll("form")[1].querySelectorAll("input:checked");
        a.forEach(e => {
            answerList.push(parseInt(e.value))
        });

        let myQuiz = new MyQuiz(1, document.getElementById("title").value, questionList, answerList);

    }

    function createQuiz(event) {
        event.preventDefault();
        let form = document.getElementById("form-quiz");
        let question = document.getElementById("question");
        let answers = [];
        let answerInputs = document.getElementsByName("answers");
        for (var i = 0; i < answerInputs.length; i++) {
            answers.push(answerInputs[i].value);
            answerInputs[i].value = "";
        }
        questionList.push(new QuizCreator(idQuiz, question.value, answers));
        idQuiz++;
        numberQuestion.innerText = idQuiz + 1;
        // clean Form
        question.value = "";
        if (questionList.length == 3) {
            fillQuizRadio();
            form.style.display = "none";
        }

    }

    function fillQuizRadio() {
        let quizRadioHtml = document.getElementById("quizs-radio");
        questionList.forEach(element => {
            quizRadioHtml.innerHTML += quizRadioHTML(element)
        });
    }
</script>

</html>